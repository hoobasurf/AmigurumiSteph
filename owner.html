<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Owner</title>

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:'Comic Sans MS',cursive}

body{
  background:url('Photoroom_20251212_143703.PNG') center/cover no-repeat fixed;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

/* AJOUT */
.owner-box{
  padding:15px;
  text-align:center;
}
.owner-box input,.owner-box button{
  padding:10px;
  margin:5px;
  border-radius:8px;
  border:1px solid #ccc;
}
.owner-box button{background:#ffb6c1;cursor:pointer}

/* VUES */
#viewSelector{
  display:flex;
  justify-content:center;
  gap:14px;
}
#viewSelector button{
  padding:10px 22px;
  border-radius:20px;
  border:2px solid #b84c6f;
  background:#fff0f7;
  color:#b84c6f;
  cursor:pointer;
}

/* LISTE */
.center-zone{flex:1;display:flex;justify-content:center}
#visitor-list{width:100%;max-width:1200px}

.visitor-item{text-align:center;cursor:pointer}
.visitor-item img{
  width:220px;height:220px;
  object-fit:contain;
  border:4px solid #b67385;
  background:#ffe6f0;
}
.visitor-item p{margin-top:8px;font-size:18px;color:#b84c6f;font-weight:bold}

/* VUES */
.carousel-view{display:flex;gap:40px;overflow-x:auto;padding:20px}
.grid-view{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:24px;padding:20px}
.list-view{display:flex;flex-direction:column;gap:18px;padding:20px}
.list-view img{width:140px;height:140px}

/* MODAL */
.modal-bg{
  position:fixed;inset:0;
  background:rgba(0,0,0,.65);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:1000;
}
.modal-box{
  background:#ffe6f0;
  border:4px solid #b67385;
  border-radius:18px;
  padding:18px;
  max-width:900px;width:95%;
  max-height:85vh;
  overflow-y:auto;
  text-align:center;
}
.modal-main-img{width:100%;max-height:480px;object-fit:contain}

/* ICONS */
.icon-bar{
  display:flex;
  justify-content:center;
  gap:24px;
  margin-top:12px;
}
.icon-btn{
  display:flex;
  gap:8px;
  align-items:center;
  padding:8px 14px;
  border-radius:12px;
  border:2px solid #b84c6f;
  background:#fff0f7;
  cursor:pointer;
  color:#b84c6f;
}
.heart.liked{color:#ff4b82}

/* COMMENTAIRES */
.comment{background:#fff0f7;padding:10px;border-radius:10px;margin-top:8px}

/* FORM */
.form-bg{
  position:fixed;inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:2000;
}
.form-box{
  background:#ffe6f0;
  padding:18px;
  border-radius:14px;
  border:4px solid #b67385;
  width:320px;
}
.form-box input,.form-box textarea,.form-box button{
  width:100%;
  margin-bottom:10px;
  padding:10px;
  border-radius:8px;
}

/* SIDEBAR */
#sidebar{
  position:fixed;
  left:-220px;
  top:0;
  width:220px;
  height:100%;
  background:rgba(255,230,240,.9);
  padding:20px;
  transition:.3s;
  z-index:10;
}
#sidebar.open{left:0}
#toggleSidebar{
  position:absolute;
  right:-30px;
  top:50%;
  width:30px;height:60px;
  background:#ffb6c1;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
}
#sidebar button{
  width:100%;
  margin-bottom:10px;
  padding:10px;
  border-radius:12px;
  background:#ffb6c1;
  border:none;
  cursor:pointer;
}

/* NEIGE & SWEET */
.snow,.sweet{position:fixed;inset:0;pointer-events:none;display:none}
</style>
</head>

<body>

<div class="owner-box">
  <input id="name" placeholder="Nom">
  <input id="photo" type="file" accept="image/*">
  <button id="add">Ajouter</button>
</div>

<div id="viewSelector">
  <button onclick="setView('carousel')">Carrousel</button>
  <button onclick="setView('grid')">Grille</button>
  <button onclick="setView('list')">Liste</button>
</div>

<div class="center-zone">
  <div id="visitor-list"></div>
</div>

<!-- MODAL -->
<div class="modal-bg" id="modal" onclick="closeModal()">
  <div class="modal-box" onclick="event.stopPropagation()">
    <img id="modalImg" class="modal-main-img">

    <div class="icon-bar">
      <div class="icon-btn" onclick="openLikeForm()">
        <span id="heart" class="heart">â™¡</span>
        <span id="likeCount">0</span>
      </div>
      <div class="icon-btn" onclick="openCommentForm()">ðŸ’¬ <span id="commentCount">0</span></div>
    </div>

    <div id="comments"></div>
  </div>
</div>

<!-- FORMS -->
<div class="form-bg" id="likeForm">
  <div class="form-box">
    <input id="likeName" placeholder="PrÃ©nom">
    <button onclick="submitLike()">Jâ€™aime</button>
  </div>
</div>

<div class="form-bg" id="commentForm">
  <div class="form-box">
    <input id="commentName" placeholder="PrÃ©nom">
    <textarea id="commentText" placeholder="Commentaire"></textarea>
    <button onclick="submitComment()">Envoyer</button>
  </div>
</div>

<!-- SIDEBAR -->
<div id="sidebar">
  <div id="toggleSidebar">â˜°</div>
  <button onclick="setTheme('default')">DÃ©faut</button>
  <button onclick="setTheme('noel')">ðŸŽ„ NoÃ«l</button>
  <button onclick="setTheme('sweety')">ðŸŒ¸ Sweety</button>
</div>

<div class="snow" id="snow"></div>
<div class="sweet" id="sweet"></div>

<script>
let creations=JSON.parse(localStorage.getItem('creations')||'[]');
let view='carousel';
let index=null;

/* RENDER */
function render(){
  const list=document.getElementById('visitor-list');
  list.innerHTML='';
  list.className=view+'-view';
  creations.forEach((c,i)=>{
    const d=document.createElement('div');
    d.className='visitor-item';
    d.innerHTML=`<img src="${c.imgUrl}"><p>${c.name}</p>`;
    d.onclick=()=>openModal(i);
    list.appendChild(d);
  });
  refreshBorders();
}

/* ADD */
add.onclick=()=>{
  if(!name.value||!photo.files[0])return;
  const r=new FileReader();
  r.onload=e=>{
    creations.unshift({name:name.value,imgUrl:e.target.result});
    localStorage.setItem('creations',JSON.stringify(creations));
    render();
    name.value='';photo.value='';
  };
  r.readAsDataURL(photo.files[0]);
};

/* VIEW */
function setView(v){view=v;render()}

/* MODAL */
function openModal(i){
  index=i;
  modalImg.src=creations[i].imgUrl;
  modal.style.display='flex';
  loadLikes();loadComments();
}
function closeModal(){modal.style.display='none'}

/* LIKE */
function openLikeForm(){likeForm.style.display='flex'}
function submitLike(){
  const n=likeName.value.trim();
  if(!n)return;
  const k='likes_'+index;
  let l=JSON.parse(localStorage.getItem(k)||'[]');
  if(!l.includes(n))l.push(n);
  localStorage.setItem(k,JSON.stringify(l));
  likeForm.style.display='none';
  loadLikes();
}
function loadLikes(){
  const l=JSON.parse(localStorage.getItem('likes_'+index)||'[]');
  likeCount.textContent=l.length;
  heart.textContent=l.length?'â¤ï¸':'â™¡';
  heart.classList.toggle('liked',l.length);
}

/* COMMENT */
function openCommentForm(){commentForm.style.display='flex'}
function submitComment(){
  const n=commentName.value,t=commentText.value;
  if(!n||!t)return;
  const k='comments_'+index;
  let c=JSON.parse(localStorage.getItem(k)||'[]');
  c.push({n,t});
  localStorage.setItem(k,JSON.stringify(c));
  commentForm.style.display='none';
  loadComments();
}
function loadComments(){
  const c=JSON.parse(localStorage.getItem('comments_'+index)||'[]');
  commentCount.textContent=c.length;
  comments.innerHTML=c.map(x=>`<div class="comment"><b>${x.n}</b><br>${x.t}</div>`).join('');
}

/* SIDEBAR */
toggleSidebar.onclick=()=>sidebar.classList.toggle('open');

/* THEME */
function setTheme(t){
  snow.style.display=sweet.style.display='none';
  if(t==='noel'){body.style.backgroundImage="url('noel.png')";snow.style.display='block'}
  else if(t==='sweety'){body.style.backgroundImage="url('sweety-girly.png')";sweet.style.display='block'}
  else body.style.backgroundImage="url('Photoroom_20251212_143703.PNG')";
  refreshBorders();
}

/* BORDURES */
function refreshBorders(){
  document.querySelectorAll('.visitor-item img').forEach(i=>{
    i.style.border=body.style.backgroundImage.includes('noel')
      ?"6px dashed red":"4px solid #b67385";
  });
}

/* EFFECTS */
setInterval(()=>snow.style.display==='block'&&(()=>{let f=document.createElement('div');f.textContent='â„';f.style.position='absolute';f.style.left=Math.random()*innerWidth+'px';snow.appendChild(f);setTimeout(()=>f.remove(),3000)})(),150);
setInterval(()=>sweet.style.display==='block'&&(()=>{let c=document.createElement('div');c.textContent='ðŸ¬';c.style.position='absolute';c.style.left=Math.random()*innerWidth+'px';sweet.appendChild(c);setTimeout(()=>c.remove(),3000)})(),200);

render();
</script>

</body>
</html>
