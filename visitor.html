<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Galerie - Mes créations</title>

<style>
  /* =========================
     RESET / GLOBAL
     ========================= */
  * { box-sizing: border-box; margin:0; padding:0; }
  html, body {
    height: 100%;
    font-family: 'Comic Sans MS', cursive;
    overflow-y: hidden;           /* Bloque scroll vertical */
    touch-action: pan-x;          /* Autorise glissement horizontal */
  }

  body {
    margin: 0;
    padding: 0;
    background-image: url('Photoroom_20251212_143703.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;  /* Fond fixe */
    background-color: #fff0f5;     /* pastel derrière si image non chargée */
    display: flex;
    flex-direction: column;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* =========================
     HEADER
     ========================= */
  header {
    position: relative;
    background: transparent;
    padding: 40px 20px 20px;
    text-align: center;
    border-radius: 0;
    box-shadow: none;
    flex-shrink: 0;
  }
  header img {
    width: 98px; height: 98px;
    display:block; margin:0 auto 12px;
    border-radius:20%; box-shadow:0 4px 12px rgba(184,76,111,0.18);
  }
  .title {
    font-size:42px; color:#b84c6f; font-weight:bold;
    letter-spacing:1px; text-shadow:0 2px 4px rgba(184,76,111,0.15);
    display:inline-block;
  }
  .title-thread {
    position:absolute; left:50%; transform:translateX(-50%);
    bottom:14px; width:240px; height:6px; background:#b84c6f;
    border-radius:20px; box-shadow:0 3px 6px rgba(184,76,111,0.08); opacity:0.85;
  }

  /* =========================
     VIEW SELECTOR
     ========================= */
  #viewSelector {
    display:flex; justify-content:center; gap:12px; margin:14px 12px;
  }
  #viewSelector button {
    background:#fff0f7;
    border:2px solid #b84c6f;
    color:#b84c6f;
    padding:8px 16px; border-radius:24px;
    font-size:15px; cursor:pointer;
    transition: all 0.18s ease;
  }
  #viewSelector button.active {
    background: linear-gradient(90deg, #ffeaf2, #fff5f8);
    color:#7a2b45;
    box-shadow:0 6px 14px rgba(184,76,111,0.12);
    transform:translateY(-2px);
  }
  #viewSelector button:hover { transform:translateY(-2px); }

  /* =========================
     CENTER ZONE & CAROUSEL
     ========================= */
  .center-zone { flex:1; display:flex; align-items:center; justify-content:center; padding:8px; transform:translateY(-40px); }
  #visitor-list { width:calc(100% - 40px); max-width:1200px; margin:0 auto; transition:all 0.2s ease; }

  .carousel-view { display:flex; gap:40px; overflow-x:auto; scroll-behavior:smooth; align-items:center; padding:10px; }
  .carousel-view::-webkit-scrollbar { height:8px; }
  .carousel-view::-webkit-scrollbar-thumb { background:#b84c6f66; border-radius:20px; }
  .visitor-item.active img { transform:scale(1.16); box-shadow:0 10px 22px rgba(184,76,111,0.30); }
  .carousel-view .visitor-item img { width:260px; height:260px; border-radius:28px; border:4px solid rgba(184,76,111,0.25); background:transparent; }

  .visitor-item { text-align:center; cursor:pointer; user-select:none; }
  .visitor-item img {
    display:block;
    margin:0 auto;
    object-fit:contain;
    transition: transform 0.28s ease, box-shadow 0.28s ease;
  }
  .visitor-item:hover img {
    transform: scale(1.05);
    box-shadow:0 10px 22px rgba(184,76,111,0.25);
  }
  .visitor-item p {
    margin:12px 0 0; font-size:20px; color:#b84c6f; font-weight:bold; line-height:1.1;
  }

  @media (max-width:720px){
    .carousel-view .visitor-item img { width:200px; height:200px; }
  }
</style>
</head>
<body>

<header>
  <img src="favicon.png" alt="Logo">
  <h1 class="title">Mes créations</h1>
  <div class="title-thread" aria-hidden="true"></div>
</header>

<div id="viewSelector">
  <button id="btnCarousel">Carrousel</button>
  <button id="btnGrid">Grille</button>
  <button id="btnList">Liste</button>
</div>

<div class="center-zone">
  <div id="visitor-list" role="list"></div>
</div>

<script>
const list = document.getElementById('visitor-list');

let creations = JSON.parse(localStorage.getItem('creations') || '[]');

let currentIndex = null;
let currentView = 'carousel';

function escapeHtml(s){ return s?String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'):''; }

function renderVisitor(){
  list.innerHTML = '';
  list.className = currentView==='carousel'? 'carousel-view' : currentView==='grid'? 'grid-view' : 'list-view';
  creations.forEach((item,i)=>{
    const div=document.createElement('div');
    div.className='visitor-item';
    div.setAttribute('data-index',i);
    div.innerHTML=`<img src="${item.imgUrl}" alt="${escapeHtml(item.name)}"><p>${escapeHtml(item.name)}</p>`;
    div.addEventListener('click',()=>openModal(i));
    list.appendChild(div);
  });
  updateCenter();
}

function setView(mode){
  currentView=mode;
  document.getElementById('btnCarousel').classList.toggle('active',mode==='carousel');
  document.getElementById('btnGrid').classList.toggle('active',mode==='grid');
  document.getElementById('btnList').classList.toggle('active',mode==='list');
  renderVisitor();
}

document.getElementById('btnCarousel').addEventListener('click',()=>setView('carousel'));
document.getElementById('btnGrid').addEventListener('click',()=>setView('grid'));
document.getElementById('btnList').addEventListener('click',()=>setView('list'));
setView(currentView);

function updateCenter(){
  if(currentView!=='carousel'){ document.querySelectorAll('.visitor-item').forEach(it=>it.classList.remove('active')); return; }
  const items=document.querySelectorAll('.visitor-item');
  const center=window.innerWidth/2;
  items.forEach(item=>{
    const rect=item.getBoundingClientRect();
    const itemCenter=rect.left+rect.width/2;
    if(Math.abs(itemCenter-center)<170) item.classList.add('active');
    else item.classList.remove('active');
  });
}

list.addEventListener('scroll',updateCenter);
window.addEventListener('resize',updateCenter);

function openModal(i){ /* modal inchangé */ }
function closeModal(){ /* modal inchangé */ }
function backgroundClose(e){ /* modal inchangé */ }

const observer = new MutationObserver(()=>updateCenter());
observer.observe(list,{childList:true,subtree:true});
setTimeout(updateCenter,200);
</script>

</body>
</html>
