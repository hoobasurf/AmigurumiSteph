<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Galerie - Mes créations</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

<style>
/* ================= RESET ================= */
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;font-family:'Comic Sans MS',cursive}

/* ================= APP ================= */
body{
  background-image:url('Photoroom_20251212_143703.png');
  background-size:cover;
  background-position:center top;
  background-repeat:no-repeat;
  background-attachment:fixed;
  overflow-x:hidden;
}

/* ================= INTRO ================= */
#intro-overlay{
  position:fixed;
  inset:0;
  z-index:99999;
  background:url('Photoroom_20251213_123235.png') center/cover no-repeat;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}

#intro-overlay.hidden{
  opacity:0;
  pointer-events:none;
  transition:opacity 1.2s ease;
}

#welcome-btn{
  padding:16px 36px;
  background:#ffb6c1;
  color:#8b3a3a;
  font-size:22px;
  font-weight:bold;
  border:none;
  border-radius:28px;
  cursor:pointer;
  box-shadow:0 6px 20px rgba(0,0,0,.25);
}

#welcome-btn:hover{background:#ff9fb8}

#intro-video{
  display:none;
  width:80%;
  max-width:820px;
  border-radius:20px;
  pointer-events:none;
}

/* ================= HEADER ================= */
header{text-align:center;padding:12px}
header img{width:98px;height:98px;border-radius:20%}
.title{font-size:42px;color:#b84c6f;font-weight:bold;margin-bottom:12px}

/* ================= VIEW BUTTONS ================= */
#viewSelector{
  display:flex;
  justify-content:center;
  gap:12px;
  margin-bottom:14px
}
#viewSelector button{
  background:#fff0f7;
  border:2px solid #b84c6f;
  color:#b84c6f;
  padding:8px 16px;
  border-radius:24px;
  cursor:pointer;
}
#viewSelector button.active{background:#ffeaf2}

/* ================= CONTENT ================= */
.center-zone{display:flex;justify-content:center}
#visitor-list{width:calc(100% - 40px);max-width:1200px}

.carousel-view{display:flex;gap:40px;overflow-x:auto}
.carousel-view img{width:260px;height:260px}

.grid-view{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:24px}
.grid-view img{width:100%;height:200px}

.list-view{display:flex;flex-direction:column;gap:18px}
.list-view img{width:140px;height:140px}

.visitor-item{text-align:center;cursor:pointer}
.visitor-item img{
  object-fit:contain;
  border:4px solid #b67385;
  border-radius:14px;
}
.visitor-item p{margin-top:8px;color:#b84c6f;font-weight:bold}
</style>
</head>

<body>

<!-- ================= INTRO ================= -->
<div id="intro-overlay">
  <video id="intro-video" playsinline muted preload="auto">
    <source src="chat.webm" type="video/webm">
  </video>
  <button id="welcome-btn">Bienvenue</button>
</div>

<!-- ================= APP ================= -->
<header>
  <img src="favicon.png">
  <h1 class="title">Mes créations</h1>
</header>

<div id="viewSelector">
  <button id="btnCarousel" class="active">Carrousel</button>
  <button id="btnGrid">Grille</button>
  <button id="btnList">Liste</button>
</div>

<div class="center-zone">
  <div id="visitor-list"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

<script>
/* ================= INTRO LOGIC ================= */
const overlay=document.getElementById('intro-overlay');
const btn=document.getElementById('welcome-btn');
const video=document.getElementById('intro-video');

btn.onclick=()=>{
  btn.style.display='none';
  video.style.display='block';
  video.play();

  video.onended=()=>{
    setTimeout(()=>{
      overlay.classList.add('hidden');
      setTimeout(()=>overlay.remove(),1200);
    },2000);
  };
};

/* ================= SUPABASE ================= */
const supabase = supabase.createClient(
  "https://iubbxvipgofxasatmvzg.supabase.co",
  "sb_publishable_GDoZmwIdoP28XOdrfYYVNw_E_HiCQB1"
);

const list=document.getElementById('visitor-list');
let creations=[];
let view='carousel';

async function loadCreations(){
  const {data,error}=await supabase.storage.from('owners').list();
  if(error)return;
  creations=data.map(f=>({
    name:f.name,
    img:supabase.storage.from('owners').getPublicUrl(f.name).publicURL
  }));
  render();
}

function render(){
  list.className=view+'-view';
  list.innerHTML='';
  creations.forEach(c=>{
    const d=document.createElement('div');
    d.className='visitor-item';
    d.innerHTML=`<img src="${c.img}"><p>${c.name}</p>`;
    list.appendChild(d);
  });
}

btnCarousel.onclick=()=>{view='carousel';render()};
btnGrid.onclick=()=>{view='grid';render()};
btnList.onclick=()=>{view='list';render()};

loadCreations();
</script>

</body>
</html>
