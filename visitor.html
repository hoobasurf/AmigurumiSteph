<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Galerie Projets – Visitor</title>
<style>
body {
  margin:0;
  font-family:sans-serif;
  background:#fff0f5;
  overflow-x:hidden;
  padding-left:35px; /* pour l'encoche */
}

/* ================= INTRO + BOUTON ================= */
#intro-container{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:100000;
  background: url('Photoroom_20251213_123235.png') center center / cover no-repeat;
}

#intro-video {
  width:80%;
  max-width:800px;
  border-radius:16px;
  pointer-events:none;
}

#welcome-btn {
  position:absolute;
  z-index:100001;
  padding:14px 28px;
  background:#ffb6c1;
  color:#8b3a3a;
  font-weight:bold;
  font-size:18px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);
}
#welcome-btn:hover {
  background:#ff9fc1;
}

/* ================= GALERIE ================= */
h1 {
  text-align:center;
  color:#b84c6f;
  margin-top:20px;
}

#visitor-list {
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:15px;
  margin:20px;
}

.visitor-item {
  background:#ffe6f0;
  border:2px solid #b67385;
  border-radius:16px;
  padding:10px;
  text-align:center;
}

.visitor-item img {
  width:110px;
  height:110px;
  object-fit:cover;
  border-radius:10px;
}

.visitor-item p {
  margin:5px 0 0;
  color:#8b3a3a;
  font-weight:bold;
}
</style>
</head>
<body>

<!-- INTRO VIDEO + BOUTON -->
<div id="intro-container">
  <video id="intro-video" playsinline webkit-playsinline preload="auto">
    <source src="chat.webm" type="video/webm">
  </video>
  <button id="welcome-btn">Bienvenue</button>
</div>

<h1>✨ Projets réalisés</h1>
<div id="visitor-list"></div>

<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

const supabaseUrl = 'https://xxxx.supabase.co';
const supabaseKey = 'PUBLIC_ANON_KEY';
const supabase = createClient(supabaseUrl, supabaseKey);

const visitorList = document.getElementById("visitor-list");
const introContainer = document.getElementById('intro-container');
const video = document.getElementById('intro-video');
const welcomeBtn = document.getElementById('welcome-btn');

// Clique sur le bouton "Bienvenue" pour lancer la vidéo
welcomeBtn.onclick = () => {
  video.play().catch(e => console.log("Autoplay bloqué :", e));
  welcomeBtn.style.display = 'none';

  video.onended = () => {
    introContainer.style.transition = "opacity 1.2s";
    introContainer.style.opacity = 0;
    setTimeout(() => introContainer.remove(), 2000); // reste 2 secondes
  };
};

// Charger les créations depuis le bucket Supabase
async function renderVisitor() {
  visitorList.innerHTML = "";
  const { data, error } = await supabase.storage
    .from('creations')
    .list('', { limit: 100 });

  if (error) return console.error(error);

  for (let file of data) {
    const { publicURL } = supabase.storage
      .from('creations')
      .getPublicUrl(file.name);

    const div = document.createElement("div");
    div.className = "visitor-item";
    div.innerHTML = `
      <img src="${publicURL}">
      <p>${file.name}</p>
    `;
    visitorList.appendChild(div);
  }
}

renderVisitor();
</script>

</body>
</html>
