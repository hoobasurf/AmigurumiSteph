<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Galerie - Mes crÃ©ations</title>

<style>
* { box-sizing: border-box; margin:0; padding:0; }
html, body { height:100%; font-family:'Comic Sans MS', cursive; }

body {
  background-image: url('Photoroom_20251212_143703.png');
  background-size: contain;
  background-position: center top;
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-color: #fff0f5;

  display: flex;
  flex-direction: column;
  min-height: 100vh;
  overflow: hidden; /* bloque scroll du body */
}

/* HEADER FIXE */
header {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  text-align: center;
  z-index: 50;
  padding: 12px 0;
  background: transparent;
}
header img {
  width: 98px;
  height: 98px;
  border-radius: 20%;
  display: block;
  margin: 0 auto;
}
.title { font-size:42px; color:#b84c6f; font-weight:bold; text-align:center; margin-top:8px; }

/* VIEW SELECTOR */
#viewSelector {
  display:flex; justify-content:center; gap:12px; margin:140px 12px 12px;
  z-index: 40;
  position: relative;
}
#viewSelector button {
  background:#fff0f7; border:2px solid #b84c6f; color:#b84c6f;
  padding:8px 16px; border-radius:24px; cursor:pointer;
}
#viewSelector button.active { background:#ffeaf2; }

/* ZONE VISITOR */
.center-zone {
  flex:1;
  display:flex;
  justify-content:center;
  padding-top: 60px; /* espace pour header fixe */
  width: 100%;
  overflow: hidden;
}
#visitor-list { width:100%; max-width:1200px; }

/* ITEMS */
.visitor-item img {
  will-change: transform;
  transform-origin: center center;
  width: 260px; height: 260px; object-fit: contain;
  border: 4px solid #b67385;
  background: transparent;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.visitor-item:hover img {
  transform: scale(1.02);
  box-shadow: 0 8px 20px rgba(184,76,111,0.3);
}
.visitor-item p {
  margin:8px 0 0; font-size:20px; color:#b84c6f; font-weight:bold; text-align:center;
}

/* CAROUSEL */
.carousel-view { display:flex; gap:40px; overflow-x:auto; scroll-behavior:smooth; padding:20px; }
.carousel-view::-webkit-scrollbar { height:8px; }
.carousel-view::-webkit-scrollbar-thumb { background:#b84c6f88; border-radius:20px; }

/* GRID */
.grid-view { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:24px; padding:20px; overflow-y:auto; max-height: calc(100vh - 200px); overscroll-behavior: contain; }

/* LIST */
.list-view { display:flex; flex-direction:column; gap:18px; padding:20px; overflow-y:auto; max-height: calc(100vh - 200px); overscroll-behavior: contain; }
.list-view .visitor-item { display:flex; gap:18px; align-items:center; }
.list-view .visitor-item img { width:140px; height:140px; }

/* MODAL */
.modal-bg {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  overflow: auto;
}
.modal-box {
  background: rgba(255,245,248,0.95);
  border-radius: 18px;
  padding: 18px;
  max-width: 900px;
  width: 95%;
  box-shadow: 0 0 20px 2px rgba(184,76,111,0.3);
  position: relative;
}
.modal-main-img { width:100%; max-height:500px; object-fit:contain; border:4px solid #b67385; }

/* ICON BAR */
.icon-bar { display:flex; justify-content:center; gap:30px; margin-top:12px; }
.icon-btn { display:flex; align-items:center; gap:8px; cursor:pointer; color:#b84c6f; }
.heart { font-size:26px; }
.heart.liked { color:#ff4b82; }
.comment-icon { font-size:22px; }
.like-info, .comment-info { font-size:14px; }

/* COMMENTS */
.comment-section { margin-top:16px; max-height:300px; overflow-y:auto; }
.comment { background:#fff0f7; padding:10px; border-radius:10px; margin-bottom:10px; }

/* COMMENT FORM */
.comment-form-bg {
  position: fixed;
  inset:0;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content:center;
  align-items:center;
  z-index:2000;
}
.comment-form {
  background:white;
  padding:18px;
  border-radius:14px;
  width:340px;
}
.comment-form input, .comment-form textarea {
  width:100%; margin-bottom:10px; padding:10px; border-radius:8px;
}
button.back-btn {
  margin-top:12px; padding:10px 20px; border:none; border-radius:26px; background: linear-gradient(90deg,#ffaadf,#b84c6f); color:white; cursor:pointer; font-size:16px;
}
</style>
</head>
<body>

<header>
  <img src="favicon.png" alt="Logo">
  <h1 class="title">Mes crÃ©ations</h1>
</header>

<div id="viewSelector">
  <button id="btnCarousel">Carrousel</button>
  <button id="btnGrid">Grille</button>
  <button id="btnList">Liste</button>
</div>

<div class="center-zone">
  <div id="visitor-list"></div>
</div>

<!-- MODAL -->
<div class="modal-bg" id="modal" onclick="closeModal()">
  <div class="modal-box" onclick="event.stopPropagation()">
    <img id="modalMain" class="modal-main-img">
    <div class="icon-bar">
      <div class="icon-btn" onclick="toggleLike();event.stopPropagation()">
        <span id="heart" class="heart">â™¡</span>
        <span id="likeCount" class="like-info">0</span>
      </div>
      <div class="icon-btn" onclick="openCommentForm();event.stopPropagation()">
        <span class="comment-icon">ðŸ’¬</span>
        <span id="commentCount" class="comment-info">0</span>
      </div>
    </div>
    <div id="commentsList" class="comment-section"></div>
    <button class="back-btn" onclick="closeModal();event.stopPropagation()">Retour</button>
  </div>
</div>

<!-- COMMENT FORM -->
<div class="comment-form-bg" id="commentFormBg" onclick="closeCommentForm(event)">
  <div class="comment-form" onclick="event.stopPropagation()">
    <input id="commentName" placeholder="PrÃ©nom">
    <textarea id="commentText" rows="4" placeholder="Commentaire"></textarea>
    <button onclick="submitComment()">Envoyer</button>
  </div>
</div>

<script>
const list = document.getElementById('visitor-list');
const modal = document.getElementById('modal');
const modalMain = document.getElementById('modalMain');
const heart = document.getElementById('heart');
const likeCount = document.getElementById('likeCount');
const commentCount = document.getElementById('commentCount');
const commentList = document.getElementById('commentsList');
const commentFormBg = document.getElementById('commentFormBg');
const commentName = document.getElementById('commentName');
const commentText = document.getElementById('commentText');

let creations = JSON.parse(localStorage.getItem('creations')||'[]');
let currentIndex = null;
let currentView = 'carousel';

function render() {
  list.innerHTML='';
  list.className=currentView+'-view';
  creations.forEach((c,i)=>{
    const d=document.createElement('div');
    d.className='visitor-item';
    d.innerHTML=`<img src="${c.imgUrl}"><p>${c.name}</p>`;
    d.onclick=()=>openModal(i);
    list.appendChild(d);
  });
}

function setView(v){
  currentView=v;
  render();
}
btnCarousel.onclick=()=>setView('carousel');
btnGrid.onclick=()=>setView('grid');
btnList.onclick=()=>setView('list');

function openModal(i){
  currentIndex=i;
  modalMain.src=creations[i].imgUrl;
  modal.style.display='flex';
  loadLikes();
  loadComments();
}

function closeModal(){ modal.style.display='none'; }

function toggleLike(){
  const name = prompt("Ton prÃ©nom pour liker cette image:")||"Anonyme";
  const key='likes_'+currentIndex;
  let likes=JSON.parse(localStorage.getItem(key)||'[]');
  if(!likes.includes(name)) likes.push(name);
  localStorage.setItem(key,JSON.stringify(likes));
  loadLikes();
}

function loadLikes(){
  const likes=JSON.parse(localStorage.getItem('likes_'+currentIndex)||'[]');
  heart.classList.toggle('liked',likes.length>0);
  heart.textContent=likes.length?'â¤ï¸':'â™¡';
  likeCount.textContent=likes.length>0 ? ` ${likes.join(', ')}` : 0;
}

function openCommentForm(){ commentFormBg.style.display='flex'; }
function closeCommentForm(e){ if(e.target===commentFormBg) commentFormBg.style.display='none'; }

function submitComment(){
  const n=commentName.value.trim();
  const t=commentText.value.trim();
  if(!n||!t) return;
  const key='comments_'+currentIndex;
  const c=JSON.parse(localStorage.getItem(key)||'[]');
  c.push({n,t});
  localStorage.setItem(key,JSON.stringify(c));
  commentName.value=''; commentText.value='';
  commentFormBg.style.display='none';
  loadComments();
}

function loadComments(){
  const c=JSON.parse(localStorage.getItem('comments_'+currentIndex)||'[]');
  commentCount.textContent=c.length;
  commentList.innerHTML=c.map(x=>`<div class="comment"><strong>${x.n}</strong><br>${x.t}</div>`).join('');
}

render();
</script>

</body>
</html>
