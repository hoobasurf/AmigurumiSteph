<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vidéos</title>
<style>
html, body {
  margin:0;
  padding:0;
  font-family:'Comic Sans MS',cursive;
  height:100%;
  background:#fff0f5;
}

/* FOND */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background-image:url('IMG_1722.jpeg');
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
  z-index:-1;
}

/* SIDEBAR */
#sidebar{
  position:fixed;
  top:0;
  left:-220px;
  width:220px;
  height:100vh;
  background:rgba(255,230,240,0.2);
  border-right:2px solid #b67385;
  padding:20px;
  transition:left .3s;
  z-index:100;
}
#sidebar.sidebar-open{left:0}
#toggleSidebar{
  position:absolute;
  top:50%;
  right:-30px;
  width:30px;
  height:60px;
  background:#ffb6c1;
  border-radius:0 12px 12px 0;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  font-weight:bold;
  color:white;
}
#backBtn{
  width:auto;
  padding:8px 16px;
  border-radius:16px;
  border:none;
  background:#ffb6c1;
  color:#fff;
  cursor:pointer;
  font-weight:bold;
  margin-top:10px;
}

/* CONTENU PRINCIPAL */
#main{
  margin-left:20px; /* pour que le contenu soit visible derrière sidebar */
  padding:20px;
}
.video-container{
  margin-bottom:20px;
  border:2px solid #b67385;
  border-radius:12px;
  overflow:hidden;
  background:white;
  padding:10px;
}
.video-container video{
  width:100%;
  max-height:300px;
}
.video-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:5px;
}
.video-header button{
  background:#ffb6c1;
  color:white;
  border:none;
  border-radius:12px;
  padding:4px 10px;
  cursor:pointer;
}
.transcription{
  margin-top:10px;
  line-height:1.5;
  font-size:14px;
}
.transcription span.active{
  background:pink;
}
.video-list{
  margin-top:20px;
}
.video-list-item{
  padding:6px 10px;
  border:1px solid #b67385;
  border-radius:12px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.video-list-item button{
  padding:2px 6px;
  border:none;
  border-radius:8px;
  background:#ffb6c1;
  color:white;
  cursor:pointer;
}
</style>
</head>
<body>

<!-- SIDEBAR -->
<div id="sidebar">
  <div id="toggleSidebar">☰</div>
  <button id="backBtn">Retour</button>
</div>

<!-- CONTENU -->
<div id="main">
  <h2>Mes Vidéos</h2>

  <!-- Zone vidéo -->
  <div id="currentVideo" class="video-container" style="display:none;">
    <div class="video-header">
      <strong id="videoTitle">Titre de la vidéo</strong>
      <button id="renameBtn">Renommer</button>
    </div>
    <video id="videoPlayer" controls></video>
    <div class="transcription" id="transcription"></div>
  </div>

  <!-- Liste des vidéos -->
  <div class="video-list" id="videoList"></div>

  <!-- Ajouter vidéo -->
  <input type="file" id="videoInput" accept="video/*">
</div>

<script>
// Sidebar toggle
document.getElementById('toggleSidebar').onclick = () => {
  document.getElementById('sidebar').classList.toggle('sidebar-open');
};

// Retour
document.getElementById('backBtn').onclick = () => {
  document.body.style.transition='opacity 0.5s';
  document.body.style.opacity='0';
  setTimeout(()=>{ window.location.href='owner.html'; },500);
};

// Gestion des vidéos
let videos = []; // stocker vidéos
const videoInput = document.getElementById('videoInput');
const videoList = document.getElementById('videoList');
const currentVideo = document.getElementById('currentVideo');
const videoPlayer = document.getElementById('videoPlayer');
const videoTitle = document.getElementById('videoTitle');
const transcriptionDiv = document.getElementById('transcription');

videoInput.addEventListener('change', (e)=>{
  const file = e.target.files[0];
  if(!file) return;

  const url = URL.createObjectURL(file);
  const videoObj = {title:file.name, url:url, transcription:["Bonjour","Ceci","est","une","démo"], time:0};
  videos.push(videoObj);
  renderVideoList();
});

// Afficher liste vidéos
function renderVideoList(){
  videoList.innerHTML="";
  videos.forEach((v,i)=>{
    const div = document.createElement('div');
    div.className="video-list-item";
    div.innerHTML=`<span>${v.title}</span>`;
    const openBtn = document.createElement('button');
    openBtn.textContent="Ouvrir";
    openBtn.onclick=()=>openVideo(i);
    const delBtn = document.createElement('button');
    delBtn.textContent="Supprimer";
    delBtn.onclick=()=>{ videos.splice(i,1); renderVideoList(); if(currentVideo.style.display!=="none") currentVideo.style.display="none"; };
    div.appendChild(openBtn);
    div.appendChild(delBtn);
    videoList.appendChild(div);
  });
}

// Ouvrir vidéo
function openVideo(index){
  const v = videos[index];
  videoPlayer.src = v.url;
  videoTitle.textContent = v.title;
  currentVideo.style.display="block";
  renderTranscription(v);
}

// Renommer vidéo
document.getElementById('renameBtn').onclick = ()=>{
  const newName = prompt("Nouveau nom:", videoTitle.textContent);
  if(newName){
    const vid = videos.find(v=>v.title===videoTitle.textContent);
    if(vid){ vid.title=newName; videoTitle.textContent=newName; renderVideoList(); }
  }
};

// Transcription simulée
function renderTranscription(v){
  transcriptionDiv.innerHTML="";
  v.transcription.forEach((word,i)=>{
    const span = document.createElement('span');
    span.textContent=word+" ";
    transcriptionDiv.appendChild(span);
  });
}

// Surlignage synchronisé simulé
videoPlayer.addEventListener('timeupdate', ()=>{
  const spans = transcriptionDiv.querySelectorAll('span');
  const duration = videoPlayer.duration || 1;
  const current = Math.floor(spans.length * videoPlayer.currentTime / duration);
  spans.forEach((s,i)=> s.classList.toggle('active', i===current));
});
</script>
</body>
</html>
